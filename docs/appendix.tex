\appendix

\section{Rapid Review data}

See \Cref{table:primary-studies}, \Cref{table:secondary-studies}, and \Cref{table:tools}.

\begin{table}
\caption{Primary studies in our search results}
\label{table:primary-studies}
\begin{tabular}{ll}
Study                                                                    & Tools introduced   \\
\midrule                                                                
Tariq et al. \cite{tariq_towards_2012}                                   & SPADE on LLVM pass \\
Sultana et al. \cite{sultana_file_2013}                                  & FiPS               \\
Muniswamy-Reddy et al. 2009 \cite{muniswamy-reddy_layering_2009}         & PASSv2             \\
Muniswamy-Reddy et al. 2006 \cite{muniswamy-reddy_provenance-aware_2006} & PASS               \\
Gehani et al. \cite{gehani_spade_2012}                                   & SPADE              \\
Pohly et al. \cite{pohly_hi-fi_2012}                                     & Hi-Fi              \\
Pasquier et al. \cite{pasquier_practical_2017}                           & CamFlow            \\
Rupprecht et al. \cite{rupprecht_improving_2020}                         & Ursprung           \\
Fadolakarim et al. \cite{fadolalkarim_pandde_2016}                       & PANDDE             \\
Wang et al. \cite{wang_lprov_2018}                                       & LPROV              \\
\end{tabular}
\end{table}

\begin{table}
\caption{Secondary studies in our search results}
\label{table:secondary-studies}
\renewcommand{\arraystretch}{1.4}
\begin{tabular}{p{0.17\textwidth}p{0.34\textwidth}p{0.4\textwidth}}
Study                                       & SLRP Tools mentioned                              & Summary                                                         \\
\midrule
Li et al. \cite{li_threat_2021}             & SPADE, CamFlow, BEEP,
                                              Ma et al. \cite{ma_accurate_2015}, MPI, ProTracer,
                                              UIScope, Winnower, LDX, MCI, RAIN, RTAG, libdft,
                                              OmegaLog                                          & To survey SLRP tools for threat-dection                         \\
Berrada et al. \cite{berrada_baseline_2020} & SPADE, OPUS                                       & To establish baselines results for anomoly detection algorithms \\
Braun et al. \cite{hutchison_issues_2006}   & PASS, GenePattern, TREC, Lineage FS               & To summarize issues in automatic provenance collection          \\
Chen et al. \cite{chan_expressiveness_2017} & SPADE+auditd, OPUS, PASS, Hi-Fi, LPM              & To compare the expressiveness of OPUS and SPADE                 \\
Carat et al. \cite{carata_primer_2014}      & PASS, PASSv2, SPADE                               & To survey provenance collection and usage                       \\
Zipperle et al.
\cite{zipperle_provenance-based_2022}       & ETW, Lineage FS, DTrace, PASS, PASSv2, Panorama,
                                              SPADE, Hi-Fi, BEEP, LogGC, Sysmon, LPM, Provmon,
                                              DataTracker, PROV-Tracer, INSPECTOR, ProTracer,
                                              RecProv, MPI, RAIN, CamFlow, LPROV                & To survey provenance-based intrusion-detection systems          \\
Lee et al. \cite{lee_towards_2015}          & PASS, SPADE                                       & To survey secure provenance collection in the cloud             \\
\end{tabular}
\end{table}

\begin{table}
\caption{SLRP Tools mentioned in primary and secondary studies in our search results. "ins." stands for instrumentation}
\label{table:tools}
{
\scriptsize
\begin{tabular}{p{0.15\textwidth}p{0.15\textwidth}p{0.23\textwidth}p{0.27\textwidth}p{0.19\textwidth}}
Tool                                                          & Suitable? Sec. \ref{section:suitability-review}
                                                                                  & Collection method                               & Collection tool                               & Notes                                                         \\
\midrule
SPADE \cite{gehani_spade_2012}                                & Yes               & Audit, filesystem, compile-time, \textbf{or} source ins. & Multiple\footnotemark{}                       & Can use multiple low-level sources                            \\
OPUS \cite{balakrishnan_opus_2013}                            & Yes               & Library instrumentation                         & libc instrumentaiton                          &                                                               \\
OmegaLog \cite{hassan_omegalog_2020}                          & No source code    & Static binary ins., audit                       & Angr, auditd                                  & Finds relationships in logs in mulitple layers                \\
FiPS (File Provenance System) \cite{sultana_file_2013}        & No source code    & Filesystem ins.                                 & VFS                                           &                                                               \\
LogGC                                                         & No source code    & Audit                                           & Auditd                                        & The contribution is deleting unnecessary parts of the log     \\
RecProv \cite{ji_recprov_2016}                                & No source code    & Tracing                                         & rr, ptrace                                    &                                                               \\
PANDDE \cite{fadolalkarim_pandde_2016}                        & kernel modif.     & Filesystem ins.                                 & Custom VFS                                    &                                                               \\
Winnower \cite{hassan_towards_2018}                           & Wrong platform    & Audit                                           & auditd, SELinux, SPADE, Docker Swarm          & Specific to Docker Swarm                                      \\
URSpring                                                      & Wrong platform    & Audit and file-system ins.                      & auditd and IBM Spectrum Scale                 & Specific to IBM Spectrum Scale FS                             \\
Event Tracer for Windows \cite{noauthor_event_2021}           & Wrong platform    & Audit                                           & NT Kernel                                     & Implemented for Windows                                       \\
UIScope \cite{yang_uiscope_2020}                              & Wrong platform    & Audit                                           & ETW and accessibility service                 & Tracks grpahical user interaction                             \\
TREC \cite{vahdat_transparent_1998}                           & Wrong platform    & Audit                                           & Proc filesystem                               & Implemented for Solaris                                       \\
DTrace \cite{noauthor_about_nodate}                           & Wrong platform    & Audit                                           & Respective kernels                            & Can do event processing in kernel-space                       \\
Sysmon \cite{markruss_sysmon_2023}                            & Wrong platform    & Audit                                           & NT Kernel                                     & Implemented for Windows                                       \\
BEEP (Binary-based Execution Partition) \cite{lee_high_2017}  & Hardware-specific & Dynamic and static binary ins.                  & Intel Pin and, PEBIL                          &                                                               \\
libdft \cite{kemerlis_libdft_2012}                            & Hardware-specific & Dynamic binary ins.                             & Intel Pin                                     &                                                               \\
RAIN (Refinable Attack INvestigation) \cite{ji_rain_2017}     & Hardware-specific & Library, kernel-level, dynamic binary ins.      & libc ins., custom kernel module, Intel Pin    & Records syscalls during runtime, replays offline under a DIFT \\
DataTracker \cite{stamatogiannakis_looking_2015}              & Hardware-specific & Dinamic binary ins.                             &                                               &                                                               \\
INSPECTOR                                                     & Hardware-specific & Library ins., ISA extensions                    & libthreads ins., Intel PT ISA extensions      &                                                               \\
MPI (Multiple Perspectives attack Investigation)
\cite{ma_mpi_2017}                                            & Unsuitable method & Compile-time ins.                               & LLVM pass                                     & Requires manual input                                         \\
LDX (Lightweight Dual Execution) \cite{kwon_ldx_2016}         & Unsuitable method & Compile-time ins.                               & LLVM pass                                     &                                                               \\
MCI (Modeling-based Causality Inference) \cite{kwon_mci_2018} & Unsuitable method & Compile-time ins.                               & LDX (LLVM pass)                               &                                                               \\
Ma et al. \cite{ma_accurate_2015}                             & Unsuitable method & Kernel ins.                                     & ETW                                           &                                                               \\
S2Logger \cite{suen_s2logger_2013}                            & Unsuitable method & Kernel ins.                                     & Custom kernel module or Linux Security Module &                                                               \\
ProTracer \cite{ma_protracer_2016}                            & Unsuitable method & Kernel ins.                                     & Linux tracepoints, custom kernel module       &                                                               \\
Hi-Fi \cite{pohly_hi-fi_2012}                                 & Unsuitable method & Kernel ins.                                     & Linux Security Module                         &                                                               \\
Lineage FS \cite{sar_lineage_nodate}                          & Unsuitable method & Kernel ins.                                     & Modified kernel                               &                                                               \\
PASS/Pasta \cite{muniswamy-reddy_provenance-aware_2006}       & Unsuitable method & Kernel ins., filesystem ins.                    & Modified kernel, VFS                          &                                                               \\
PASSv2/Lasagna \cite{muniswamy-reddy_layering_2009}           & Unsuitable method & Kernel ins., filesystem, library ins.           & Modified kernel, instrumented libc, VFS       &                                                               \\
RTAG \cite{ji_enabling_2018}                                  & Unsuitable method & Kernel ins.                                     & Modified kernel                               & Record/reply like RAIN                                        \\
LPM/ProvMon \cite{bates_trustworthy_2015}                     & Unsuitable method & Kernel ins.                                     & Modified kernel, kernel module, NetFilter     &                                                               \\
CamFlow \cite{pasquier_practical_2017}                        & Unsuitable method & Kernel ins.                                     & Linux Security Module and NetFilter           &                                                               \\
LPROV \cite{wang_lprov_2018}                                  & Unsuitable method & Kernel, dynamic binary, static binary ins.      & Custom kernel module, custom loader, BEEP     &                                                               \\
Panorama \cite{yin_panorama_2007}                             & Unsuitable method & VM ins.                                         & QEMU                                          &                                                               \\
PROV-Tracer \cite{stamatogiannakis_decoupling_2015}           & Unsuitable method & VM ins.                                         & QEMU, PANDA                                   &                                                               \\
\end{tabular}
}

\footnotetext{
SPADE can use multiple backends, including other provenance collectors.
On Linux, SPADE can use: Auditd, CamFlow, FUSE;
On MacOS: OpenBSM, MacFUSE, Fuse4x;
On Windows: ProcessMonitor;
On any platform: import static data (e.g., from logs on disk), applications instrumented with API, applications compiled with LLVM pass.
Given our requiremnts, SPADE+auditd and SPADE+FUSE are the only suitable SPADE configurations.
}
\end{table}

%% \section{Performance data}

%% \begin{table}
%%   \begin{tabular}{llll}
%%     Tool         &  \\
%%     \midrule                                                                                                                                            
%%     SPADE+auditd & - & - \\
%%     bpftrace     & - & - \\
%%     SPADE+FUSE   & \\
%%     strace       & \\
%%     ltrace       & \\
%%     fsatrace     & \\
%%     Darshan      & \\
%%   \end{tabular}
%%   \caption{Summarized results}
%%   \label{table:filtered-candidates}
%% \end{table}
